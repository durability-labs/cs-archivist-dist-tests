services:
  archivist-base:
    image: durabilitylabs/archivist-node:latest-dist-tests
    pull_policy: always
    restart: always
    command:
      - archivist
      # - persistence
    environment:
      # - NETWORK=testnet - after 0.0.1
      - BOOTSTRAP_NODE_FROM_URL=https://spr.archivist.storage/testnet # 0.0.1
      - ARCHIVIST_DATA_DIR=/data
      - ARCHIVIST_LOG_LEVEL=TRACE;warn:discv5,providers,manager,cache;warn:libp2p,multistream,switch,transport,tcptransport,semaphore,asyncstreamwrapper,lpstream,mplex,mplexchannel,noise,bufferstream,mplexcoder,secure,chronosstream,connection,connmanager,websock,ws-session
      - ARCHIVIST_API_PORT=8080
      - ARCHIVIST_API_BINDADDR=0.0.0.0
      - ARCHIVIST_LISTEN_ADDRS=/ip4/0.0.0.0/tcp/8070
      - ARCHIVIST_API_CORS_ORIGIN=*
      - ARCHIVIST_DISC_PORT=8090
      - ARCHIVIST_STORAGE_QUOTA=20gb
      - NAT_PUBLIC_IP_AUTO=https://ip.archivist.storage
      # - ARCHIVIST_ETH_PROVIDER=https://rpc.testnet.archivist.storage/
    logging:
      driver: json-file
      options:
        max-size: 100m
        max-file: 5
    # May be necessary on some host machines:
    # network_mode: host
